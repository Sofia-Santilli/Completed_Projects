<!DOCTYPE html>
<html>

<script id="vertex-shader" type="x-shader/x-vertex">
#version 300 es

precision mediump float;

in vec4 aPosition;

in vec2 aTexCoord;
out vec2 vTexCoord;


uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;

in vec3 aNormal;
in vec3 aTangent;
uniform vec4 uLightPosition;
uniform mat3 uNormalMatrix;
out vec3 N, E, L, V;

uniform float uObjectIndex;



out vec4 vColor;
uniform vec4 uAmbientProduct, uDiffuseProduct, uSpecularProduct;
uniform float uShininess;



void main()
{
    if(uObjectIndex==0.2){
        vec3 pos = (modelViewMatrix*aPosition).xyz;
        vec3 eyeLightPos = (modelViewMatrix*uLightPosition).xyz;

        vec3 N = normalize(uNormalMatrix*aNormal.xyz);
        vec3 T = normalize(uNormalMatrix*aTangent.xyz);
        vec3 B = cross(N, T);

        L.x = dot(T, eyeLightPos - pos);
        L.y = dot(B, eyeLightPos - pos);
        L.z = dot(N, eyeLightPos - pos);
        L = normalize(L);

        V.x = dot(T, -pos);
        V.y = dot(B, -pos);
        V.z = dot(N, -pos);
        V = normalize(V);
    }
    else{
        vec3 pos = (modelViewMatrix * aPosition).xyz;

        vec3 light = (modelViewMatrix * uLightPosition).xyz;  
        //multiplied for modelViewMatrix xk√® otherwise the light on the other objects moved with the camera
        vec3 L = normalize(light - pos);

        vec3 E = normalize(-pos);
        vec3 H = normalize(L + E);

        vec4 NN = vec4(aNormal, 0);

        vec3 N = normalize((modelViewMatrix*NN).xyz);

        vec4 ambient = uAmbientProduct;

        float Kd = max(dot(L, N), 0.0);
        vec4 diffuse = Kd * uDiffuseProduct;

        float Ks = pow(max(dot(N, H), 0.0), uShininess);
        vec4 specular = Ks * uSpecularProduct;

        if(dot(L, N) < 0.0){
            specular = vec4(0.0, 0.0, 0.0, 1.0);
        }
        vColor = ambient + diffuse + specular;
        vColor.a = 1.0;
    }

    gl_Position = projectionMatrix * modelViewMatrix * aPosition;

    vTexCoord = aTexCoord;
}
</script>

<script id="fragment-shader" type="x-shader/x-fragment">
#version 300 es

precision mediump float;

uniform float uObjectIndex;

in vec2 vTexCoord;
uniform sampler2D uTextureMap;
uniform sampler2D uTextureMap_wood;
uniform sampler2D uTextureMap_sheep;
uniform sampler2D uTextureMap_sheep_image;
uniform sampler2D uTextureMap_sheep_face;

in vec3 N, E, L, V;
uniform vec4 uDiffuseProduct_sheep;


in vec4 vColor;

out vec4 fColor;


void main()
{

    if(uObjectIndex==0.0){          // head and tail of the sheep 
        //fColor = vec4(0.8, 0.8, 0.8, 1.0);
        fColor = vColor * texture(uTextureMap_sheep_image, vTexCoord);
    }
    else if(uObjectIndex==0.1){     // lower legs
        //fColor = vec4(1.0, 0.87, 0.99, 1.0);  
        fColor = vColor * vec4(1.0, 0.7, 0.75, 1.0);  
    }
    else if(uObjectIndex==0.2){     // torso of the sheep which has a bump texture
        //fColor = vec4(1.0, 0.8, 0.8, 1.0);  
        //fColor = texture(uTextureMap_sheep, vTexCoord); 

        vec4 N = texture(uTextureMap_sheep, vTexCoord);
        vec3 NN = normalize(2.0 * N.xyz - 1.0);
        vec3 LL = normalize(L);
        float kd = max(dot(NN, LL), 0.0);

        fColor = vec4(kd * uDiffuseProduct_sheep.xyz, 1.0);

    }
    else if(uObjectIndex==0.3){
        fColor = vColor * texture(uTextureMap_sheep_face, vTexCoord);
    }
    else if(uObjectIndex==1.0){     //grass
        //fColor = vec4(0.0, 1.0, 0.0, 1.0);
        fColor = vColor * texture(uTextureMap, vTexCoord);  //texture image of grass
    } 
    else if(uObjectIndex==2.0) { //wood of the fence
        //fColor = vec4(0.66, 0.34, 0.0, 1.0);
        fColor = vColor * texture(uTextureMap_wood, vTexCoord); 
    }


}
</script>

<script type="text/javascript" src="../Common/InitShaders.js"></script>
<script type="text/javascript" src="../Common/MVnew.js"></script>
<script type="text/javascript" src="Homework2.js"></script>



<div>
    Chenge the torso angle in order to see better the bump effect: 
     -180 <input id="slider0" type="range"
     min="-180" max="180" step="10" value="0"
      />
     180
</div><br/>



<p> Move the Camera: 
    <button id = "ThetaCameraIncrease">Increase Theta</button>
    <button id = "ThetaCameraDecrease">Decrease Theta</button>
    <button id = "PhiCameraIncrease">Increase Phi</button>
    <button id = "PhiCameraDecrease">Decrease Phi</button>
</p>

<div>
    radius -40 <input id="sliderRadius" type="range"
     min="-40" max="40" step="1" value="5"
      />
     40

    --- depth 0.1<input id="depthSlider" type="range"
    min="0.1" max="30" step="0.5" value="23" />30

    <button id = "Button9">Wider</button>
    <button id = "Button10">Narrower</button>
    <button id = "Button11">Higher</button>
    <button id = "Button12">Shorter</button>
</div>
<br/>

<p> START ANIMATION:  
    <button id = "ButtonStart">Start animation</button>
    ----- RESET: 
    <button id = "ButtonReset">Reset</button> 
</p>






<body>
<canvas id="gl-canvas" width="812" height="612">
Oops ... your browser doesn't support the HTML5 canvas element
</canvas>
</body>
</html>
